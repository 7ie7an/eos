#+TITLE: EOS: Elasticsearch Module
#+PROPERTY: header-args:emacs-lisp :tangle yes
#+PROPERTY: header-args:sh :eval no

#+BEGIN_SRC emacs-lisp
(provide 'eos-es)
#+END_SRC

* Elasticsearch

#+BEGIN_SRC emacs-lisp
(use-package es-mode
  :ensure t
  :init
  (add-to-list 'auto-mode-alist '("\\.es$" . es-mode))
  :config
  (setq es-warn-on-delete-query nil))
#+END_SRC

* ES Services started and Run from Emacs

I basically use this to start up ES when I need to test something really quickly

I have been trying out [[https://www.npmjs.com/package/esvm][esvm]] for this lately also, check out my ESVM
configuration elsewhere in my dotfiles

So I configure prodigy like so:

#+BEGIN_SRC emacs-lisp
(use-package prodigy
  :ensure t
  :defer t
  :config
  (setq prodigy-services '())
  (prodigy-define-service
    :name "ES 2.x, 3 nodes"
    :cwd "~/ies/"
    :command "esvm"
    :args '("3node")
    :tags '(work test es)
    :port 9200)

  (prodigy-define-service
    :name "ES 2.x, 2 nodes"
    :cwd "~/ies/"
    :command "esvm"
    :args '("2node")
    :tags '(work test es)
    :port 9200)

  (prodigy-define-service
    :name "ES master branch"
    :cwd "~/ies/"
    :command "esvm"
    :args '("master")
    :tags '(work test es)
    :port 9200)

  (prodigy-define-service
    :name "Kibana 4.4.0"
    :cwd "~/ies/kibana-4.4.0-linux-x64"
    :command "~/ies/kibana-4.4.0-linux-x64/bin/kibana"
    :tags '(work kibana)
    :port 5601)

  (prodigy-define-service
    :name "Elasticsearch 1.7.5"
    :cwd "~/ies/elasticsearch-1.7.5"
    :command "~/ies/elasticsearch-1.7.5/bin/elasticsearch"
    :tags '(work test es)
    :port 9200)
  (prodigy-define-service
    :name "Elasticsearch 2.1.2"
    :cwd "~/ies/elasticsearch-2.1.2"
    :command "~/ies/elasticsearch-2.1.2/bin/elasticsearch"
    :tags '(work test es)
    :port 9200)
  (prodigy-define-service
    :name "Elasticsearch 2.2.0"
    :cwd "~/ies/elasticsearch-2.2.0"
    :command "~/ies/elasticsearch-2.2.0/bin/elasticsearch"
    :tags '(work test es)
    :port 9200)
  (prodigy-define-service
    :name "ES gradle run"
    :cwd "~/es/elasticsearch"
    :command "gradle"
    :args '("run")
    :tags '(work es)
    :port 9200))
#+END_SRC
